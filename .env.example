# Core
AUDIT_NODE_ID=node-1
AUDIT_LOG_PATH=/var/log/xray/access.log
AUDIT_ERROR_LOG_PATH=/var/log/xray/error.log
AUDIT_ERROR_LOG_ENABLED=true
AUDIT_ERROR_MIN_LEVEL=warning
AUDIT_ERROR_DROP_NOISE=false
AUDIT_FLUSH_INTERVAL_SECONDS=1
AUDIT_BATCH_SIZE=300
AUDIT_POLL_INTERVAL_SECONDS=0.2

# MySQL
AUDIT_MYSQL_HOST=127.0.0.1
AUDIT_MYSQL_PORT=3306
AUDIT_MYSQL_USER=xray_audit
AUDIT_MYSQL_PASSWORD=change-me
AUDIT_MYSQL_DB=xray_audit
AUDIT_MYSQL_CHARSET=utf8mb4

# Redis
AUDIT_REDIS_URL=redis://127.0.0.1:6379/0
AUDIT_REDIS_ENABLED=true

# Docker compose helper (not read by application directly)
# Host path that contains Xray access.log and error.log.
AUDIT_HOST_XRAY_LOG_DIR=/usr/local/x-ui
# Optional pinned image tag for compose:
# XRAY_AUDIT_IMAGE=ghcr.io/zcl19/xray-audit:v0.1.0

# API
AUDIT_API_HOST=127.0.0.1
AUDIT_API_PORT=8088
AUDIT_COLLECTOR_EMBEDDED=false

# Filter noisy internal traffic
AUDIT_DROP_API_TO_API=true
AUDIT_DROP_LOOPBACK_TRAFFIC=true
AUDIT_DROP_INVALID_VLESS_PROBE=false
# Example: api -> api,dns_inbound -> hkt
AUDIT_EXCLUDE_DETOURS=

# Data retention
# Keep only N days of history; set <=0 to disable auto cleanup.
AUDIT_RETENTION_DAYS=30
# Run retention cleanup every N seconds.
AUDIT_RETENTION_CLEANUP_INTERVAL_SECONDS=3600
# Delete in small batches to avoid long table locks.
AUDIT_RETENTION_DELETE_BATCH_SIZE=5000

# GeoIP lookup (for source IP ownership column)
AUDIT_GEOIP_ENABLED=true
AUDIT_GEOIP_PROVIDER_URL=https://whois.pconline.com.cn/ipJson.jsp
AUDIT_GEOIP_TIMEOUT_SECONDS=3
AUDIT_GEOIP_CACHE_TTL_HOURS=168
AUDIT_GEOIP_BATCH_LIMIT=200

# AI summary -> Telegram (OpenAI-compatible API)
AUDIT_AI_SUMMARY_ENABLED=false
AUDIT_AI_SUMMARY_INTERVAL_SECONDS=1800
AUDIT_AI_SUMMARY_WINDOW_MINUTES=60
AUDIT_AI_SUMMARY_MAX_ITEMS=200
AUDIT_AI_API_BASE_URL=
AUDIT_AI_API_KEY=
AUDIT_AI_API_MODEL=gpt-4o-mini
AUDIT_AI_API_TIMEOUT_SECONDS=20
AUDIT_TG_BOT_TOKEN=
AUDIT_TG_CHAT_ID=

# Runtime config hot-refresh
AUDIT_RUNTIME_CONFIG_REFRESH_SECONDS=3

# Auth (built-in login, JWT cookie)
AUDIT_AUTH_ENABLED=true
AUDIT_AUTH_ALLOW_ANONYMOUS_HEALTH=false
AUDIT_AUTH_JWT_SECRET=change-this-secret-in-production
AUDIT_AUTH_JWT_EXP_SECONDS=43200
AUDIT_AUTH_COOKIE_NAME=xray_audit_session
AUDIT_AUTH_COOKIE_SECURE=true
AUDIT_AUTH_COOKIE_SAMESITE=lax
AUDIT_AUTH_COOKIE_DOMAIN=
AUDIT_AUTH_LOGIN_RATE_LIMIT=8
AUDIT_AUTH_LOGIN_RATE_WINDOW_SECONDS=300

# Bootstrap admin user (used only when admin table is empty)
AUDIT_ADMIN_BOOTSTRAP_USERNAME=admin
AUDIT_ADMIN_BOOTSTRAP_PASSWORD=ChangeMe123!
